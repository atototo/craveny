# Story 1.8: initial-data-collection

**Epic:** 1 - 데이터 수집 및 저장 인프라
**Status:** Completed

---

## Story

**As a** 개발자,
**I want** 과거 3개월 뉴스 및 주가 데이터를 일괄 수집하는 스크립트를 실행하여,
**so that** MVP 시작 시점에 충분한 학습 데이터(500~1,000건)가 확보된다.

---

## Acceptance Criteria

1. 일괄 수집 스크립트(`scripts/initial_data_collection.py`)가 제공된다.
2. 과거 3개월의 증권 뉴스를 크롤링하여 PostgreSQL에 저장한다.
3. 동일 기간의 주가 데이터를 수집하여 PostgreSQL에 저장한다.
4. 뉴스-주가 매칭 및 변동률을 계산하여 저장한다.
5. 모든 뉴스를 임베딩하여 Milvus에 저장한다.
6. 최소 500건 이상의 뉴스가 Milvus에 저장된다.
7. 스크립트 실행 시간은 2시간 이내로 완료된다.
8. 로컬 테스트: 스크립트 완료 후 데이터 건수 확인이 성공한다.

---

## Tasks / Subtasks

- [ ] Task 1: 스크립트 구조 설계 (AC: 1)
  - [ ] `scripts/initial_data_collection.py` 생성
  - [ ] argparse로 CLI 인터페이스
  - [ ] 진행 상황 표시 (tqdm)

- [ ] Task 2: 과거 뉴스 크롤링 (AC: 2)
  - [ ] 3개월 날짜 범위 설정
  - [ ] 뉴스 크롤러 재사용
  - [ ] 배치 저장

- [ ] Task 3: 과거 주가 데이터 수집 (AC: 3)
  - [ ] FinanceDataReader로 일봉 데이터 수집
  - [ ] 대형주 50개 종목
  - [ ] stock_prices 테이블 저장

- [ ] Task 4: 뉴스-주가 매칭 (AC: 4)
  - [ ] news_stock_matcher 로직 재사용
  - [ ] 변동률 계산

- [ ] Task 5: 일괄 임베딩 (AC: 5, 6)
  - [ ] embedder 로직 재사용
  - [ ] 100건씩 배치 처리
  - [ ] 최소 500건 검증

- [ ] Task 6: 성능 최적화 (AC: 7)
  - [ ] 병렬 처리 (ThreadPoolExecutor)
  - [ ] DB 배치 커밋

- [ ] Task 7: 검증 및 테스트 (AC: 8)
  - [ ] 뉴스 건수 확인
  - [ ] Milvus 벡터 건수 확인
  - [ ] 실행 시간 측정

---

## Dev Notes

### Script Structure

```python
# scripts/initial_data_collection.py

def main():
    # 1. 과거 뉴스 크롤링
    # 2. 주가 데이터 수집
    # 3. 뉴스-주가 매칭
    # 4. 임베딩 및 Milvus 저장
    # 5. 검증

if __name__ == "__main__":
    main()
```

### Performance Targets

- 뉴스 크롤링: 500건 / 30분
- 주가 수집: 50종목 × 90일 / 10분
- 임베딩: 500건 / 20분
- 총 실행 시간: <2시간

### Testing

**Test Cases:**
1. 스크립트 실행 성공
2. PostgreSQL 데이터 건수 검증
3. Milvus 벡터 건수 검증
4. 실행 시간 <2시간

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-31 | 1.0 | Story created from Epic 1 | Sarah (PO) |

---

## Dev Agent Record

### Agent Model Used

_To be populated by Dev Agent_

### Debug Log References

_To be populated by Dev Agent_

### Completion Notes List

_To be populated by Dev Agent_

### File List

_To be populated by Dev Agent_

---

## QA Results

_To be populated by QA Agent_
